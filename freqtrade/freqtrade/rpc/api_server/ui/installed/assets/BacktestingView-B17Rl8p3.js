import{H as L,c as p,a as r,e as d,Z as ze,$ as He,a0 as ie,a1 as Ue,N as Fe,d as M,u as z,r as q,j as V,U as te,b as s,f as e,i as Z,h as f,F as S,m as I,z as x,k as b,g as H,x as R,n as Q,l as B,a2 as Ne,Y as W,t as U,o as Y,K as ae,a3 as je,G as j,D as K,a4 as Oe,a5 as Ee,y as de,Q as Ge,W as We,s as ue,v as Ke,a6 as Ze,a7 as re,w as O,B as me,I as Qe,a8 as Ye,V as Xe,a9 as Je,X as et}from"./index-D1nGKoiE.js";import{_ as tt,a as st,b as at,c as lt,d as ot,s as nt}from"./index-CMA_eroL.js";import{_ as le}from"./DraggableContainer.vue_vue_type_script_setup_true_lang-BeWeePSk.js";import{c as fe,i as it,d as rt}from"./TradeList.vue_vue_type_script_setup_true_lang-DiHhF1As.js";import{_ as _e,a as ct,b as dt,c as pe}from"./InfoBox.vue_vue_type_script_setup_true_lang-BrAeT5j_.js";import{s as ut}from"./index-CP60bJgW.js";import{_ as mt,s as ft}from"./CandleChartContainer-IwOvXMbF.js";import{_ as _t,a as pt,b as kt}from"./TradesLogChart-Cd8rHebG.js";import{u as ke,s as be,i as ve,a as ye,b as ge,c as he,d as Be}from"./installCanvasRenderer-4trk6N7K.js";import{d as bt,e as vt,i as yt,a as gt,b as xe,c as Re,f as we,g as ht}from"./chartZoom-pugbQQdv.js";import{s as E,a as G}from"./index-BTUVlsjz.js";import{g as $e,a as ce,s as Bt,b as xt}from"./index-L-TDb3Ra.js";import{s as Rt}from"./index-yJSdiZHo.js";import{_ as wt}from"./TimeRangeSelect.vue_vue_type_script_setup_true_lang-DkXyeAfZ.js";import{s as $t}from"./index-CEpCyxkv.js";import{_ as Ct,a as Tt}from"./StrategySelect.vue_vue_type_script_setup_true_lang-C4ChGlx0.js";import{_ as Vt}from"./check-DEKslqbd.js";import"./index-CjZ0zNgp.js";import"./index-BBrH4yNu.js";import"./index-hZriSoxw.js";import"./plus-box-outline-DggSO52U.js";import"./index-MFsE8z5E.js";import"./index-B2wo9FRq.js";const St={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mt(o,t){return r(),p("svg",St,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6z"},null,-1)])])}const oe=L({name:"mdi-chevron-right",render:Mt});var At=`
    .p-radiobutton-group {
        display: inline-flex;
    }
`,qt={root:"p-radiobutton-group p-component"},Pt=ze.extend({name:"radiobuttongroup",style:At,classes:qt}),Lt={name:"BaseRadioButtonGroup",extends:He,style:Pt,provide:function(){return{$pcRadioButtonGroup:this,$parentInstance:this}}},Ce={name:"RadioButtonGroup",extends:Lt,inheritAttrs:!1,data:function(){return{groupName:this.name}},watch:{name:function(t){this.groupName=t||ie("radiobutton-group-")}},mounted:function(){this.groupName=this.groupName||ie("radiobutton-group-")}};function Dt(o,t,l,_,m,a){return r(),p("div",Fe({class:o.cx("root")},o.ptmi("root")),[Ue(o.$slots,"default")],16)}Ce.render=Dt;const It={class:"flex justify-center"},zt=["for"],Ht={class:"divide-y divide-surface-300 dark:divide-surface-700 divide-solid border-x border-y rounded-sm border-surface-300 dark:border-surface-700"},Ut=["title","onClick"],Ft={class:"flex"},Nt={class:"flex flex-col"},jt={key:0},Ot={key:0},Et={class:"px-3 m-0 list-disc list-inside"},Gt={key:0},Wt=M({__name:"TradeListNav",props:{trades:{},backtestMode:{type:Boolean,default:!1}},emits:["trade-select"],setup(o,{emit:t}){const l=o,_=t,m=z(),a=q({}),i=q(!0),u=q("openDate"),n=[{text:"Open date",value:"openDate"},{text:"Profit %",value:"profit"}],c=g=>{a.value=g,_("trade-select",g)},y=V(()=>{const g=u.value==="profit"?"profit_ratio":"open_timestamp";return i.value?l.trades.slice().sort((v,w)=>w[g]-v[g]):l.trades.slice().sort((v,w)=>v[g]-w[g])}),k=q(y.value.map(()=>!1));return te(()=>m.activeBot.selectedPair,()=>{k.value=y.value.map(()=>!1)}),(g,v)=>{const w=ut,T=Ce,h=H,A=_e,$=ct,N=dt,X=oe,J=Ne;return r(),p("div",null,[d("div",It,[v[2]||(v[2]=d("span",{class:"me-2"},"Sort by:",-1)),s(T,{modelValue:e(u),"onUpdate:modelValue":v[0]||(v[0]=C=>Z(u)?u.value=C:null),options:n,name:"radio-options"},{default:f(()=>[(r(),p(S,null,I(n,C=>d("div",{key:C.value,class:"flex items-center"},[s(w,{id:`id-${C.value}`,value:C.value},null,8,["id","value"]),d("label",{for:`id-${C.value}`},x(C.text),9,zt)])),64))]),_:1},8,["modelValue"])]),d("ul",Ht,[s(h,{severity:"secondary",variant:"text",class:"w-full flex flex-wrap justify-center items-center",title:"Trade Navigation",onClick:v[1]||(v[1]=C=>i.value=!e(i))},{default:f(()=>[R("Trade Navigation "+x(e(i)?"↓":"↑"),1)]),_:1}),(r(!0),p(S,null,I(e(y),(C,D)=>(r(),p("li",{key:C.open_timestamp,class:Q(["flex flex-col py-1 px-1 items-stretch",{"bg-primary-100 dark:bg-primary-800 text-primary-contrast":C.open_timestamp===e(a).open_timestamp}]),title:`${C.pair}`,onClick:P=>c(C)},[d("div",Ft,[d("div",Nt,[d("div",null,[e(m).activeBot.botState.trading_mode!=="spot"?(r(),p("span",jt,x(C.is_short?"S-":"L-"),1)):b("",!0),s(A,{date:C.open_timestamp},null,8,["date"])]),s($,{trade:C,class:"my-1"},null,8,["trade"]),o.backtestMode?(r(),B(N,{key:0,"profit-ratio":C.profit_ratio,"stake-currency":e(m).activeBot.stakeCurrency},null,8,["profit-ratio","stake-currency"])):b("",!0)]),s(h,{size:"small",class:"ms-auto mt-auto",variant:"outlined",severity:"secondary",onClick:P=>e(k)[D]=!e(k)[D]},{default:f(()=>[e(k)[D]?b("",!0):(r(),B(X,{key:0,width:"24",height:"24"})),e(k)[D]?(r(),B(J,{key:1,width:"24",height:"24"})):b("",!0)]),_:2},1032,["onClick"])]),s(W,null,{default:f(()=>[e(k)[D]?(r(),p("div",Ot,[d("ul",Et,[(r(!0),p(S,null,I(C.orders?.filter(P=>P.order_filled_timestamp!==null),P=>(r(),p("li",{key:P.order_timestamp},x(P.ft_order_side)+" "+x(P.amount)+" at "+x(P.safe_price),1))),128))])])):b("",!0)]),_:2},1024)],10,Ut))),128)),o.trades.length===0?(r(),p("div",Gt,"No trades to show...")):b("",!0)])])}}}),Kt=U(Wt,[["__scopeId","data-v-6e6742b0"]]),Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qt(o,t){return r(),p("svg",Zt,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6z"},null,-1)])])}const Te=L({name:"mdi-chevron-left",render:Qt}),Yt={class:"flex flex-row mb-1 items-center"},Xt={class:"me-2"},Jt={class:"grow"},es={class:"text-end"},ts={class:"text-center flex flex-row h-full items-stretch overflow-x-clip"},ss=M({__name:"BacktestResultChart",props:{timeframe:{},strategy:{},freqaiModel:{},timerange:{},backtestResult:{}},setup(o){const t=o,l=z(),_=q({right:!0,left:!0}),m=q();function a(u){m.value={startValue:u.open_timestamp,endValue:u.close_timestamp}}function i(u,n){l.activeBot.getPairHistory({pair:u,timeframe:t.timeframe,timerange:t.timerange,strategy:t.strategy,freqaimodel:t.freqaiModel,columns:n,margin_mode:t.backtestResult.margin_mode,trading_mode:t.backtestResult.trading_mode})}return Y(()=>{if(!l.activeBot.selectedPair&&t.backtestResult.pairlist.length>0){const[u]=t.backtestResult.pairlist;u&&(l.activeBot.selectedPair=u)}}),(u,n)=>{const c=oe,y=Te,k=H,g=tt,v=mt,w=Kt,T=fe,h=le;return r(),p("div",null,[d("div",Yt,[d("div",Xt,[s(k,{"aria-label":"Close",title:"Pair Navigation",severity:"secondary",variant:"outlined",size:"small",onClick:n[0]||(n[0]=A=>e(_).left=!e(_).left)},{default:f(()=>[e(_).left?b("",!0):(r(),B(c,{key:0,width:"24",height:"24"})),e(_).left?(r(),B(y,{key:1,width:"24",height:"24"})):b("",!0)]),_:1})]),d("span",Jt,[n[2]||(n[2]=R(" Graph will always show the latest values for the selected strategy. ",-1)),n[3]||(n[3]=d("br",null,null,-1)),R(" Timerange: "+x(o.timerange)+" - "+x(o.strategy),1)]),d("div",es,[s(k,{"aria-label":"Close",variant:"outlined",title:"Trade Navigation",size:"small",severity:"secondary",onClick:n[1]||(n[1]=A=>e(_).right=!e(_).right)},{default:f(()=>[e(_).right?(r(),B(c,{key:0,width:"24",height:"24"})):b("",!0),e(_).right?b("",!0):(r(),B(y,{key:1,width:"24",height:"24"}))]),_:1})])]),d("div",ts,[s(W,{name:"fadeleft"},{default:f(()=>[e(_).left?(r(),B(g,{key:0,class:"overflow-y-auto overflow-x-hidden",style:{"max-height":"calc(100vh - 200px)"},pairlist:o.backtestResult.pairlist,trades:o.backtestResult.trades,"starting-balance":o.backtestResult.starting_balance,"sort-method":"profit","backtest-mode":!0},null,8,["pairlist","trades","starting-balance"])):b("",!0)]),_:1}),s(v,{"available-pairs":o.backtestResult.pairlist,"historic-view":"","reload-data-on-switch":"",timeframe:o.timeframe,timerange:o.timerange,strategy:o.strategy,trades:o.backtestResult.trades,class:"flex-1 candle-chart-container px-0 h-full align-self-stretch min-w-0","slider-position":e(m),"freqai-model":o.freqaiModel,onRefreshData:i},null,8,["available-pairs","timeframe","timerange","strategy","trades","slider-position","freqai-model"]),s(W,{name:"fade"},{default:f(()=>[e(_).right?(r(),B(w,{key:0,class:"overflow-y-auto overflow-x-visible min-w-56",style:{"max-height":"calc(100vh - 200px)"},trades:o.backtestResult.trades.filter(A=>A.pair===e(l).activeBot.selectedPair),onTradeSelect:a},null,8,["trades"])):b("",!0)]),_:1})]),s(h,{header:"Single trades",class:"row mt-2 w-full"},{default:f(()=>[s(T,{class:"row trade-history mt-2 w-full",trades:o.backtestResult.trades,"show-filter":!0},null,8,["trades"])]),_:1})])}}}),as=U(ss,[["__scopeId","data-v-397d5afb"]]),ee="Market change %",ls=M({__name:"MarketChangeChart",props:{marketChangeData:{},showTitle:{type:Boolean,default:!0}},setup(o){ke([yt,gt,ve,xe,ye,Re,ge,he,Be,we]);const t=o,l=ae(),_=q(null),m=V(()=>{if(!t.marketChangeData)return{};const a=t.marketChangeData.columns.findIndex(u=>u==="__date_ts"),i=t.marketChangeData.columns.findIndex(u=>u==="rel_mean");return{title:{text:"Market change %",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{source:t.marketChangeData.data},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},grid:{...vt},legend:{data:[ee],right:"5%",top:0,selectedMode:!1},xAxis:[{type:"time",axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{type:"value",name:ee,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35}],dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...bt}],series:[{type:"line",name:ee,showSymbol:!1,color:l.chartTheme==="dark"?"#c2c2c2":"black",encode:{x:a,y:i}}]}});return(a,i)=>o.marketChangeData?.data?(r(),B(e(be),{key:0,ref_key:"marketChangeChart",ref:_,option:e(m),theme:e(l).chartTheme,autoresize:""},null,8,["option","theme"])):b("",!0)}}),os=U(ls,[["__scopeId","data-v-c38cc536"]]),ns=M({__name:"TradeDurationChart",props:{trades:{},showTitle:{type:Boolean,default:!0}},setup(o){const t=o,l=ae();ke([ye,he,Be,xe,ge,Re,it,rt,ve,we,ht]);const _=V(()=>t.trades.map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),m=V(()=>t.trades.filter(n=>n.profit_ratio>0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),a=V(()=>t.trades.filter(n=>n.profit_ratio<=0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),i=V(()=>({title:{text:"Trades durations",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:[{id:"allTrades",source:[_.value,m.value,a.value]},{id:"allTradesBoxplot",fromDatasetId:"allTrades",transform:{type:"boxplot",config:{itemNameFormatter:n=>{if(n.value===0)return"All trades";if(n.value===1)return"Winning trades";if(n.value===2)return"Losing trades"}}}},{id:"outlier",fromDatasetIndex:1,fromTransformResult:1}],xAxis:{type:"category",show:!0},yAxis:[{type:"value",name:"Trade duration",splitArea:{show:!0},axisLabel:{formatter:u}}],tooltip:{formatter:n=>{if(n.seriesType==="boxplot"){const c=n.data;return`
            <div>${n.name}</div>
            <div>Min: ${u(c[1])}</div>
            <div>Q1: ${u(c[2])}</div>
            <div>Median: ${u(c[3])}</div>
            <div>Q3: ${u(c[4])}</div>
            <div>Max: ${u(c[5])}</div>
          `}return""}},visualMap:[{type:"piecewise",show:!1,dimension:0,pieces:[{min:0,max:0,label:"All Trades",color:"#5470c6"},{min:1,max:1,label:"Winning Trades",color:"#12bb7b"},{min:2,max:2,label:"Losing Trades",color:"#ef5350"}]}],series:[{name:"Trade durations",type:"boxplot",datasetId:"allTradesBoxplot",colorBy:"data"},{name:"outlier",type:"scatter",datasetId:"outlier"}]}));function u(n){if(n>=60){const c=Math.floor(n/60),y=Math.floor(n%60);return`${c}h ${y}m`}return`${Math.floor(n)}m`}return(n,c)=>o.trades.length>0?(r(),B(e(be),{key:0,option:e(i),autoresize:"",theme:e(l).chartTheme},null,8,["option","theme"])):b("",!0)}}),is=U(ns,[["__scopeId","data-v-fe032d24"]]),rs={class:"text-center flex-fill flex flex-col h-full gap-1"},cs=M({__name:"BacktestGraphs",props:{trades:{}},setup(o){const t=z(),{state:l}=je(()=>t.activeBot.getBacktestMarketChange(),null);return(_,m)=>{const a=_t,i=pt,u=os,n=kt;return r(),p("div",rs,[s(a,{trades:o.trades,class:"flex-grow-1 chart-equal-height"},null,8,["trades"]),s(is,{class:"flex-grow-1 chart-equal-height",trades:o.trades,"show-title":!0},null,8,["trades"]),s(i,{trades:o.trades,class:"flex-grow-1 chart-equal-height","show-title":!0},null,8,["trades"]),e(l)?(r(),B(u,{key:0,"market-change-data":e(l),class:"flex-grow-1 chart-equal-height"},null,8,["market-change-data"])):b("",!0),s(n,{class:"flex-grow-1 chart-equal-height",trades:o.trades,"show-title":!0},null,8,["trades"])])}}}),ds=U(cs,[["__scopeId","data-v-f1b72a5a"]]),us={class:"flex flex-col me-2 text-start"},ms={class:"font-bold"},fs={class:"text-sm"},_s={key:0,class:"text-sm",style:{"white-space":"pre-wrap"}},Ve=M({__name:"BacktestResultSelectEntry",props:{backtestResult:{},selectedBacktestResultKey:{default:""},canUseModify:{type:Boolean,default:!1}},setup(o){return(t,l)=>(r(),p("div",us,[d("div",ms,x(o.backtestResult.metadata.strategyName)+" - "+x(o.backtestResult.strategy.timeframe),1),d("div",fs," TradeCount: "+x(o.backtestResult.strategy.total_trades)+" - Profit: "+x(("formatPercent"in t?t.formatPercent:e(j))(o.backtestResult.strategy.profit_total)),1),o.canUseModify?(r(),p("div",_s,x(o.backtestResult.metadata.notes),1)):b("",!0)]))}});function se(o,t){return Object.entries(o).reduce((_,[m,a])=>(a.forEach(i=>{const u=Object.entries(i)[0];if(!u)return;const[n,c]=u,y=_.find(k=>k[t]===n);y?y[m]=c:_.push({[t]:n,[m]:c})}),_),[])}const ps={class:"px-0 mw-full"},ks={class:"flex flex-col text-start ms-0 me-2 gap-2"},bs={class:"flex flex-col flex-xl-row"},vs={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 flex-fill"},ys={key:1},gs=M({__name:"BacktestResultComparison",props:{backtestResults:{}},setup(o){const t=o,l=V(()=>{const m={};return Object.entries(t.backtestResults).forEach(([a,i])=>{const u=$e(i.strategy);m[a]=u}),console.log(m),se(m,"metric")}),_=V(()=>{const m=[{key:"metric",label:"Metric"}];return Object.entries(t.backtestResults).forEach(([a,i])=>{m.push({key:a,label:i.metadata.strategyName})}),m});return(m,a)=>{const i=Ve,u=G,n=E;return r(),p("div",ps,[a[0]||(a[0]=d("div",{class:"flex justify-center"},[d("h3",{class:"font-bold text-3xl"},"Backtest-result comparison")],-1)),d("div",ks,[d("div",bs,[d("div",vs,[s(n,{bordered:"",value:e(l),size:"small","show-gridlines":""},{default:f(()=>[(r(!0),p(S,null,I(e(_),c=>(r(),B(u,{key:c.key,field:c.key,label:c.label},{header:f(()=>[c.key&&o.backtestResults[c.key]?(r(),B(i,{key:0,"backtest-result":o.backtestResults[c.key]},null,8,["backtest-result"])):(r(),p("span",ys,x(c.label),1))]),_:2},1032,["field","label"]))),128))]),_:1},8,["value"])])])])])}}}),hs=M({__name:"BacktestResultPeriodBreakdown",props:{periodicBreakdown:{}},setup(o){const t=o,l=V(()=>{const m=[{value:"day",text:"Days"},{value:"week",text:"Weeks"},{value:"month",text:"Months"}];return t.periodicBreakdown.year&&m.push({value:"year",text:"Years"}),t.periodicBreakdown.weekday&&m.push({value:"weekday",text:"Weekday"}),m}),_=q("month");return(m,a)=>{const i=Rt,u=G,n=E;return r(),p(S,null,[s(i,{modelValue:e(_),"onUpdate:modelValue":a[0]||(a[0]=c=>Z(_)?_.value=c:null),options:e(l),size:"small","allow-empty":!1,class:"m-2","option-label":"text","option-value":"value"},null,8,["modelValue","options"]),s(n,{size:"small",stacked:"sm",value:o.periodicBreakdown[e(_)]},{default:f(()=>[s(u,{field:"date",header:"Date"}),s(u,{field:"trades",header:"Trades"},{body:f(({data:c,field:y})=>[R(x(c[y]??"N/A"),1)]),_:1}),s(u,{field:"profit_abs",header:"Total Profit",body:"formatPrice"in m?m.formatPrice:e(K)},{body:f(({data:c,field:y})=>[R(x(c[y]?c[y].toFixed(2):"N/A"),1)]),_:1},8,["body"]),s(u,{field:"profit_factor",header:"Profit Factor"},{body:f(({data:c,field:y})=>[R(x(("formatPrice"in m?m.formatPrice:e(K))(c[y],2)),1)]),_:1}),s(u,{field:"wins",header:"Wins"}),s(u,{field:"draws",header:"Draws"}),s(u,{field:"losses",header:"Losses"},{body:f(({data:c})=>[R(x(c.loses??c.losses??"N/A"),1)]),_:1}),s(u,{field:"wins",header:"Win Rate"},{body:f(({data:c})=>[R(x((c.wins/(c.wins+c.draws+(c.loses??c.losses))*100).toFixed(2)+"%"),1)]),_:1})]),_:1},8,["value"])],64)}}}),Bs={class:"flex flex-row w-full justify-between items-center"},xs=M({__name:"BacktestResultTablePer",props:{title:{},results:{},stakeCurrency:{},stakeCurrencyDecimals:{},keyHeader:{default:""},keyHeaders:{default:()=>[]}},setup(o){const t=o,l=V(()=>t.results.map(i=>t.keyHeaders.length>0?{...i,key:typeof i.key=="string"?Array(t.keyHeaders.length).fill(i.key):i.key}:i)),_=V(()=>{const i=[];if(t.keyHeaders.length>0)for(const[u,n]of t.keyHeaders.entries())i.push({key:`key[${u}]`,label:n,formatter:(c,y)=>Array.isArray(c)?c[u]:c||y.exit_reason||"OTHER"});else i.push({key:"key",label:t.keyHeader,formatter:(u,n)=>u||n.exit_reason||"OTHER"});return i}),m=ae(),a=V(()=>ce.value.filter(i=>i.field!=="key"&&m.backtestAdditionalMetrics.includes(i.field)));return(i,u)=>{const n=Bt,c=G,y=E,k=le;return r(),B(k,null,{header:f(()=>[d("div",Bs,[R(x(o.title)+" ",1),d("div",null,[u[1]||(u[1]=R(" Shown metrics: ",-1)),s(n,{id:"backtestMetrics",modelValue:e(m).backtestAdditionalMetrics,"onUpdate:modelValue":u[0]||(u[0]=g=>e(m).backtestAdditionalMetrics=g),options:"availableBacktestMetrics"in i?i.availableBacktestMetrics:e(ce),"option-label":"header","option-value":"field",size:"small"},null,8,["modelValue","options"])])])]),default:f(()=>[s(y,{size:"small",hover:"",stacked:"sm",value:e(l)},{default:f(()=>[(r(!0),p(S,null,I(e(_),g=>(r(),B(c,{key:g.key,field:g.key,header:g.label},{body:f(({data:v})=>[R(x(g.formatter(v.key,v)),1)]),_:2},1032,["field","header"]))),128)),s(c,{field:"trades",header:"Trades"}),s(c,{field:"profit_mean",header:"Avg Profit %"},{body:f(({data:g,field:v})=>[R(x(("formatPercent"in i?i.formatPercent:e(j))(g[v],2)),1)]),_:1}),s(c,{field:"profit_total_abs",header:`Tot Profit ${t.stakeCurrency}`},{body:f(({data:g,field:v})=>[R(x(("formatPrice"in i?i.formatPrice:e(K))(g[v],t.stakeCurrencyDecimals)),1)]),_:1},8,["header"]),s(c,{field:"profit_total",header:"Tot Profit %"},{body:f(({data:g,field:v})=>[R(x(("formatPercent"in i?i.formatPercent:e(j))(g[v],2)),1)]),_:1}),s(c,{field:"wins",header:"Wins"}),s(c,{field:"draws",header:"Draws"}),s(c,{field:"losses",header:"Losses"}),(r(!0),p(S,null,I(e(a),g=>(r(),B(c,{key:g.field,field:g.field,header:g.header},{body:f(({data:v,field:w})=>[R(x(g.is_ratio?("formatPercent"in i?i.formatPercent:e(j))(v[w],2):("formatPrice"in i?i.formatPrice:e(K))(v[w],2)),1)]),_:2},1032,["field","header"]))),128))]),_:1},8,["value"])]),_:1})}}}),Rs={class:"px-0 w-full"},ws={class:"flex justify-center"},$s={class:"font-bold text-2xl mb-2"},Cs={class:"flex flex-col text-start ms-0 me-2 gap-2"},Ts={class:"flex flex-col xl:flex-row"},Vs={class:"px-0 px-xl-0 pe-xl-1 grow"},Ss={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 grow"},Ms=M({__name:"BacktestResultAnalysis",props:{backtestResult:{}},setup(o){const t=o,l=V(()=>{const m=$e(t.backtestResult);return se({value:m},"metric")}),_=V(()=>{const m=xt(t.backtestResult);return se({value:m},"setting")});return(m,a)=>{const i=G,u=E,n=le,c=xs,y=hs,k=fe;return r(),p("div",Rs,[d("div",ws,[d("h3",$s," Backtest-result for "+x(o.backtestResult.strategy_name),1)]),d("div",Cs,[d("div",Ts,[d("div",Vs,[s(n,{header:"Strategy settings"},{default:f(()=>[s(u,{size:"small",value:e(_)},{default:f(()=>[s(i,{field:"setting",header:"Setting"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})]),d("div",Ss,[s(n,{header:"Metrics"},{default:f(()=>[s(u,{size:"small",borderless:"",value:e(l)},{default:f(()=>[s(i,{field:"metric",header:"Metric"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})])]),s(c,{title:"Results per Enter tag",results:o.backtestResult.results_per_enter_tag,"stake-currency":o.backtestResult.stake_currency,"key-header":"Enter Tag","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),s(c,{title:"Results per Exit reason",results:o.backtestResult.exit_reason_summary??[],"stake-currency":o.backtestResult.stake_currency,"key-header":"Exit Reason","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),o.backtestResult.mix_tag_stats?(r(),B(c,{key:0,title:"Results Mixed Tag",results:o.backtestResult.mix_tag_stats??[],"stake-currency":o.backtestResult.stake_currency,"key-headers":["Enter Tag","Exit Tag"],"stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"])):b("",!0),s(c,{title:"Results per pair",results:o.backtestResult.results_per_pair,"stake-currency":o.backtestResult.stake_currency,"key-header":"Pair","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),o.backtestResult.periodic_breakdown?(r(),B(n,{key:1,header:"Periodic breakdown"},{default:f(()=>[s(y,{"periodic-breakdown":o.backtestResult.periodic_breakdown},null,8,["periodic-breakdown"])]),_:1})):b("",!0),s(n,{header:"Single trades"},{default:f(()=>[s(k,{trades:o.backtestResult.trades,"show-filter":!0,"stake-currency":o.backtestResult.stake_currency},null,8,["trades","stake-currency"])]),_:1})])])}}}),As={class:"w-full flex"},qs={class:"ms-2"},Ps=M({__name:"FreqaiModelSelect",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const t=Oe(o,"modelValue"),l=z();return Y(()=>{l.activeBot.freqaiModelList.length===0&&l.activeBot.getFreqAIModelList()}),(_,m)=>{const a=Ee,i=de,u=H;return r(),p("div",null,[d("div",As,[s(a,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=n=>t.value=n),options:e(l).activeBot.freqaiModelList,fluid:"",size:"small"},null,8,["modelValue","options"]),d("div",qs,[s(u,{severity:"secondary",variant:"outlined",size:"small",onClick:e(l).activeBot.getFreqAIModelList},{icon:f(()=>[s(i)]),_:1},8,["onClick"])])])])}}}),Se=Ge("btStore",{state:()=>({strategy:"",selectedTimeframe:"",selectedDetailTimeframe:"",timerange:"",maxOpenTrades:null,stakeAmount:null,startingCapital:null,allowCache:!0,enableProtections:!1,stakeAmountUnlimited:!1,freqAI:{enabled:!1,model:"",identifier:""}}),getters:{canRunBacktest:o=>o.strategy!==""},actions:{}}),Ls={class:"mb-2"},Ds=["disabled"],Is={for:"timeframe-detail-select",class:"flex justify-end items-center gap-2"},zs={class:"flex items-center"},Hs={class:"flex basis-full"},Us={class:"flex justify-end items-center"},Fs={class:"flex flex-wrap md:flex-nowrap justify-between md:justify-center"},Ns=M({__name:"BacktestRun",setup(o){const t=z(),l=Se();function _(){const m={strategy:l.strategy,timerange:l.timerange,enable_protections:l.enableProtections};if(l.maxOpenTrades&&(m.max_open_trades=l.maxOpenTrades),l.stakeAmountUnlimited)m.stake_amount="unlimited";else{const i=Number(l.stakeAmount);i&&(m.stake_amount=i.toString())}const a=Number(l.startingCapital);a&&(m.dry_run_wallet=a),l.selectedTimeframe&&(m.timeframe=l.selectedTimeframe),l.selectedDetailTimeframe&&(m.timeframe_detail=l.selectedDetailTimeframe),l.allowCache||(m.backtest_cache="none"),l.freqAI.enabled&&(m.freqaimodel=l.freqAI.model,l.freqAI.identifier!==""&&(m.freqai={identifier:l.freqAI.identifier})),t.activeBot.startBacktest(m)}return(m,a)=>{const i=Ct,u=Tt,n=pe,c=$t,y=We,k=ue,g=Ps,v=Ke,w=wt,T=H;return r(),p(S,null,[d("div",Ls,[a[13]||(a[13]=d("span",null,"Strategy",-1)),s(i,{modelValue:e(l).strategy,"onUpdate:modelValue":a[0]||(a[0]=h=>e(l).strategy=h)},null,8,["modelValue"])]),d("div",{class:"grid grid-cols-2 border border-surface-500 rounded-sm gap-y-2 gap-2 items-center p-1 pt-3",disabled:e(t).activeBot.backtestRunning},[a[20]||(a[20]=d("h3",{class:"font-bold mb-2 col-span-2 text-center"},"Backtesting parameters",-1)),a[21]||(a[21]=d("label",{for:"timeframe-select"},"Timeframe:",-1)),s(u,{id:"timeframe-select",modelValue:e(l).selectedTimeframe,"onUpdate:modelValue":a[1]||(a[1]=h=>e(l).selectedTimeframe=h),size:"small"},null,8,["modelValue"]),d("label",Is,[a[14]||(a[14]=R("Detail Timeframe: ",-1)),s(n,{hint:"Detail timeframe, to simulate intra-candle results. Not setting this will not use this functionality."})]),s(u,{id:"timeframe-detail-select",modelValue:e(l).selectedDetailTimeframe,"onUpdate:modelValue":a[2]||(a[2]=h=>e(l).selectedDetailTimeframe=h),size:"small","below-timeframe":e(l).selectedTimeframe},null,8,["modelValue","below-timeframe"]),a[22]||(a[22]=d("label",{for:"max-open-trades"},"Max open trades:",-1)),s(c,{id:"max-open-trades",modelValue:e(l).maxOpenTrades,"onUpdate:modelValue":a[3]||(a[3]=h=>e(l).maxOpenTrades=h),size:"small",placeholder:"Use strategy default",type:"number"},null,8,["modelValue"]),a[23]||(a[23]=d("label",{for:"starting-capital"},"Starting capital:",-1)),s(c,{id:"starting-capital",modelValue:e(l).startingCapital,"onUpdate:modelValue":a[4]||(a[4]=h=>e(l).startingCapital=h),size:"small",placeholder:"Use config default",type:"number",step:.001},null,8,["modelValue"]),a[24]||(a[24]=d("label",{for:"stake-amount-bool"},"Stake amount:",-1)),d("div",zs,[d("div",Hs,[s(y,{id:"stake-amount-bool",modelValue:e(l).stakeAmountUnlimited,"onUpdate:modelValue":a[5]||(a[5]=h=>e(l).stakeAmountUnlimited=h)},{default:f(()=>[...a[15]||(a[15]=[R("Unlimited stake",-1)])]),_:1},8,["modelValue"])]),s(c,{id:"stake-amount",modelValue:e(l).stakeAmount,"onUpdate:modelValue":a[6]||(a[6]=h=>e(l).stakeAmount=h),placeholder:"Use strategy default",step:.01,size:"small",disabled:e(l).stakeAmountUnlimited},null,8,["modelValue","disabled"])]),a[25]||(a[25]=d("label",{for:"enable-protections"},"Enable Protections:",-1)),s(y,{id:"enable-protections",modelValue:e(l).enableProtections,"onUpdate:modelValue":a[7]||(a[7]=h=>e(l).enableProtections=h)},null,8,["modelValue"]),e(t).activeBot.botFeatures.backtestFreqAI?(r(),p(S,{key:0},[a[16]||(a[16]=d("label",{for:"enable-cache"},"Cache Backtest results:",-1)),s(y,{id:"enable-cache",modelValue:e(l).allowCache,"onUpdate:modelValue":a[8]||(a[8]=h=>e(l).allowCache=h)},null,8,["modelValue"])],64)):b("",!0),e(t).activeBot.botFeatures.backtestFreqAI?(r(),p(S,{key:1},[d("div",Us,[a[17]||(a[17]=d("span",{class:"me-2"},"Enable FreqAI:",-1)),s(n,{hint:"Assumes freqAI configuration is setup in the configuration, and the strategy is a freqAI strategy. Will fail if that's not the case."})]),s(y,{id:"enable-freqai",modelValue:e(l).freqAI.enabled,"onUpdate:modelValue":a[9]||(a[9]=h=>e(l).freqAI.enabled=h)},null,8,["modelValue"]),e(l).freqAI.enabled?(r(),p(S,{key:0},[a[18]||(a[18]=d("label",{for:"freqai-identifier"},"FreqAI identifier:",-1)),s(k,{id:"freqai-identifier",modelValue:e(l).freqAI.identifier,"onUpdate:modelValue":a[10]||(a[10]=h=>e(l).freqAI.identifier=h),placeholder:"Use config default",size:"small"},null,8,["modelValue"])],64)):b("",!0),e(l).freqAI.enabled?(r(),p(S,{key:1},[a[19]||(a[19]=d("label",{for:"freqai-model"},"FreqAI Model:",-1)),s(g,{id:"freqai-model",modelValue:e(l).freqAI.model,"onUpdate:modelValue":a[11]||(a[11]=h=>e(l).freqAI.model=h)},null,8,["modelValue"])],64)):b("",!0)],64)):b("",!0),s(v,{class:"col-span-2"}),s(w,{modelValue:e(l).timerange,"onUpdate:modelValue":a[12]||(a[12]=h=>e(l).timerange=h),class:"mx-auto mt-2 col-span-2"},null,8,["modelValue"])],8,Ds),a[30]||(a[30]=d("h3",{class:"mt-3 font-bold text-2xl"},"Backtesting summary",-1)),d("div",Fs,[s(T,{id:"start-backtest",severity:"primary",disabled:!e(l).canRunBacktest||e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:_},{default:f(()=>[...a[26]||(a[26]=[R(" Start backtest ",-1)])]),_:1},8,["disabled"]),s(T,{severity:"secondary",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:e(t).activeBot.pollBacktest},{default:f(()=>[...a[27]||(a[27]=[R(" Load backtest result ",-1)])]),_:1},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:!e(t).activeBot.backtestRunning,onClick:e(t).activeBot.stopBacktest},{default:f(()=>[...a[28]||(a[28]=[R(" Stop Backtest ",-1)])]),_:1},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,onClick:e(t).activeBot.removeBacktest},{default:f(()=>[...a[29]||(a[29]=[R(" Reset Backtest ",-1)])]),_:1},8,["disabled","onClick"])])],64)}}}),js=U(Ns,[["__scopeId","data-v-5f7698a9"]]),Os={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Es(o,t){return r(),p("svg",Os,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M4 11v2h12l-5.5 5.5l1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5L16 11z"},null,-1)])])}const Gs=L({name:"mdi-arrow-right",render:Es}),Ws={key:0,class:"flex align-center"},Ks={key:0,class:"ms-1"},Zs={class:"flex items-center"},Qs=M({__name:"BacktestHistoryLoad",setup(o){const t=z(),l=q(),_=q(""),m=Ze(_,350,{maxWait:1e3});Y(()=>{t.activeBot.getBacktestHistory()});function a(n){const c={title:"Delete result",message:`Delete result ${n.filename} from disk?`,accept:()=>{t.activeBot.deleteBacktestHistoryResult(n)}};l.value?.show(c)}const i=V(()=>t.activeBot.backtestHistoryList.filter(n=>n.filename.toLowerCase().includes(m.value.toLowerCase())||n.strategy.toLowerCase().includes(m.value.toLowerCase())));function u(n){t.activeBot.getBacktestHistoryResult(n.data)}return(n,c)=>{const y=de,k=H,g=ue,v=G,w=_e,T=Gs,h=me,A=E;return r(),p(S,null,[d("div",null,[s(k,{class:"float-end",title:"Refresh","aria-label":"Refresh",variant:"outlined",severity:"secondary",onClick:e(t).activeBot.getBacktestHistory},{default:f(()=>[s(y)]),_:1},8,["onClick"]),c[1]||(c[1]=d("p",null," Load Historic results from disk. You can click on multiple results to load all of them into freqUI. ",-1)),e(t).activeBot.backtestHistoryList.length>0?(r(),p("div",Ws,[s(g,{id:"trade-filter",modelValue:e(_),"onUpdate:modelValue":c[0]||(c[0]=$=>Z(_)?_.value=$:null),type:"text",size:"small",placeholder:"Filter results",title:"Filter results"},null,8,["modelValue"])])):b("",!0),e(t).activeBot.backtestHistoryList.length>0?(r(),B(A,{key:1,class:"mt-2",responsive:"",size:"small",scrollable:"","scroll-height":"50rem","virtual-scroller-options":{itemSize:46},"show-gridlines":"",value:e(i),onRowClick:u},{default:f(()=>[s(v,{field:"strategy",header:"Strategy2"}),s(v,{field:"timeframe",header:"Details"},{body:f(({data:$})=>[d("strong",null,x($.timeframe),1),$.backtest_start_ts&&$.backtest_end_ts?(r(),p("span",Ks,x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(re))($.backtest_start_ts*1e3))+"-"+x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(re))($.backtest_end_ts*1e3)),1)):b("",!0)]),_:1}),s(v,{field:"backtest_start_time",header:"Backtest Time"},{body:f(({data:$})=>[s(w,{date:$.backtest_start_time*1e3},null,8,["date"])]),_:1}),s(v,{field:"filename",header:"Filename"}),s(v,{field:"actions",header:"Actions"},{body:f(({data:$})=>[d("div",Zs,[e(t).activeBot.botFeatures.backtestSetNotes?(r(),B(pe,{key:0,class:Q($.notes?"opacity-100":"opacity-0"),hint:$.notes??""},null,8,["class","hint"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(r(),B(k,{key:1,class:"ms-1",size:"small",title:"Load this Result.",disabled:$.run_id in e(t).activeBot.backtestHistory,onClick:O(N=>e(t).activeBot.getBacktestHistoryResult($),["stop"])},{icon:f(()=>[s(T)]),_:1},8,["disabled","onClick"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(r(),B(k,{key:2,class:"ms-1",size:"small",severity:"secondary",title:"Delete this Result.",disabled:$.run_id in e(t).activeBot.backtestHistory,onClick:O(N=>a($),["stop"])},{icon:f(()=>[s(h)]),_:1},8,["disabled","onClick"])):b("",!0)])]),_:1})]),_:1},8,["value"])):b("",!0)]),s(Qe,{ref_key:"msgBox",ref:l},null,512)],64)}}}),Ys={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xs(o,t){return r(),p("svg",Ys,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5c-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2c0 1.1.9 2 2 2c1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9c0-1.1-.9-2-2-2m-6 1l.9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11L4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"},null,-1)])])}const Js=L({name:"mdi-chart-timeline-variant-shimmer",render:Xs}),ea={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ta(o,t){return r(),p("svg",ea,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M4 19v1h18v2H2V2h2v15c3 0 6-2 8.1-5.6c3-5 6.3-7.4 9.9-7.4v2c-2.8 0-5.5 2.1-8.1 6.5C11.3 16.6 7.7 19 4 19"},null,-1)])])}const sa=L({name:"mdi-chart-bell-curve-cumulative",render:ta}),aa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function la(o,t){return r(),p("svg",aa,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M9 14H2v2h7v3l4-4l-4-4zm6-1v-3h7V8h-7V5l-4 4z"},null,-1)])])}const oa=L({name:"mdi-compare-horizontal",render:la}),na={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ia(o,t){return r(),p("svg",na,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M17 16.88c.56 0 1 .44 1 1s-.44 1-1 1s-1-.45-1-1s.44-1 1-1m0-3c2.73 0 5.06 1.66 6 4c-.94 2.34-3.27 4-6 4s-5.06-1.66-6-4c.94-2.34 3.27-4 6-4m0 1.5a2.5 2.5 0 0 0 0 5a2.5 2.5 0 0 0 0-5M18 3H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5.42c-.16-.32-.3-.66-.42-1c.12-.34.26-.68.42-1H4v-4h6v2.97c.55-.86 1.23-1.6 2-2.21V13h1.15c1.16-.64 2.47-1 3.85-1c1.06 0 2.07.21 3 .59V5c0-1.1-.9-2-2-2m-8 8H4V7h6zm8 0h-6V7h6z"},null,-1)])])}const ra=L({name:"mdi-table-eye",render:ia}),ca={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function da(o,t){return r(),p("svg",ca,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48q1.18-1.53 3.08-1.95q.58-2.02 2.14-3.4Q8.95 4.38 11 4.08v8.07L9.4 10.6L8 12l4 4l4-4l-1.4-1.4l-1.6 1.55V4.08q2.58.35 4.29 2.31T19 11q1.73.2 2.86 1.5q1.14 1.28 1.14 3q0 1.88-1.31 3.19T18.5 20Z"},null,-1)])])}const ua=L({name:"mdi-cloud-download",render:da}),ma={class:"flex flex-col items-stretch"},fa={class:"ms-2 divide-y border-x border-surface-500 rounded-sm border-y divide-solid divide-surface-500"},_a=["onClick"],pa={class:"flex"},ka=M({__name:"BacktestResultSelect",props:{backtestHistory:{},selectedBacktestResultKey:{default:""},canUseModify:{type:Boolean,default:!1}},emits:["selectionChange","removeResult","updateResult"],setup(o,{emit:t}){const l=t,_=a=>{l("selectionChange",a)};function m(a,i){i.metadata.editing=!i.metadata.editing,i.metadata.filename&&l("updateResult",{run_id:a,notes:i.metadata.notes??"",filename:i.metadata.filename,strategy:i.metadata.strategyName})}return(a,i)=>{const u=Ve,n=Ye,c=H,y=me,k=ft,g=Vt;return r(),p("div",ma,[i[0]||(i[0]=d("h3",{class:"font-bold text-2xl"},"Available results:",-1)),d("ul",fa,[(r(!0),p(S,null,I(Object.entries(o.backtestHistory),([v,w])=>(r(),p("li",{key:v,button:"",class:Q([{"bg-primary dark:border-primary text-primary-contrast":v===o.selectedBacktestResultKey},"flex justify-between items-center py-1 px-1"]),onClick:T=>_(v)},[w.metadata.editing?b("",!0):(r(),p(S,{key:0},[s(u,{"backtest-result":w,"can-use-modify":o.canUseModify},null,8,["backtest-result","can-use-modify"]),d("div",pa,[o.canUseModify?(r(),B(c,{key:0,class:"flex-nowrap",size:"small",severity:"secondary",title:"Modify result notes.",onClick:O(T=>w.metadata.editing=!w.metadata.editing,["stop"])},{icon:f(()=>[s(n)]),_:1},8,["onClick"])):b("",!0),s(c,{size:"small",class:"flex-nowrap",severity:"secondary",title:"Delete this Result from UI.",onClick:O(T=>l("removeResult",v),["stop"])},{icon:f(()=>[s(y)]),_:1},8,["onClick"])])],64)),w.metadata.editing?(r(),p(S,{key:1},[s(k,{modelValue:w.metadata.notes,"onUpdate:modelValue":T=>w.metadata.notes=T,placeholder:"notes",size:"small"},null,8,["modelValue","onUpdate:modelValue"]),s(c,{size:"small",title:"Confirm",onClick:O(T=>m(v,w),["stop"])},{icon:f(()=>[s(g)]),_:1},8,["onClick"])],64)):b("",!0)],10,_a))),128))])])}}}),ba={class:"flex flex-row pt-1 me-1 relative",style:{height:"calc(100vh - 60px)"}},va={class:"flex flex-col fixed"},ya={class:"flex flex-col w-full"},ga={key:0},ha={class:"w-full"},Ba=M({__name:"BacktestingView",setup(o){const t=z(),l=Se(),_=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length!==0:!1),m=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length>1:!1),a=V(()=>t.activeBot.selectedBacktestResult?.timeframe??""),i=q(!1),u=q("run"),n=q(null);function c(){t.activeBot.selectedBacktestResult&&(l.strategy=t.activeBot.selectedBacktestResult.strategy_name,t.activeBot.getStrategy(l.strategy),l.selectedTimeframe=t.activeBot.selectedBacktestResult.timeframe,l.selectedDetailTimeframe=t.activeBot.selectedBacktestResult.timeframe_detail||"",l.timerange=t.activeBot.selectedBacktestResult.timerange,l.enableProtections=t.activeBot.selectedBacktestResult.enable_protections,l.freqAI.enabled=t.activeBot.selectedBacktestResult.freqaimodel!==void 0,l.freqAI.model=t.activeBot.selectedBacktestResult.freqaimodel||"",l.freqAI.identifier=t.activeBot.selectedBacktestResult.freqai_identifier||"")}return te(()=>t.activeBot.selectedBacktestResultKey,()=>{c()}),Y(()=>t.activeBot.getState()),te(()=>t.activeBot.backtestRunning,()=>{t.activeBot.backtestRunning===!0?n.value=window.setInterval(t.activeBot.pollBacktest,1e3):n.value&&(clearInterval(n.value),n.value=null)}),(y,k)=>{const g=oe,v=Te,w=H,T=ka,h=ua,A=at,$=Je,N=ra,X=oa,J=sa,C=Js,D=st,P=Qs,F=ot,Me=js,Ae=Ms,qe=gs,Pe=ds,Le=as,De=lt,Ie=nt;return r(),p("div",ba,[e(u)!=="visualize"?(r(),p("div",{key:0,class:Q(["flex md:flex-row h-full w-16 transition-all duration-200 shrink-0 me-1 border-r border-surface-200 dark:border-surface-900",{"w-78!":e(i)}])},[d("div",va,[s(w,{class:"self-start","aria-label":"Close",size:"small",severity:"secondary",variant:"outlined",onClick:k[0]||(k[0]=ne=>i.value=!e(i))},{default:f(()=>[e(i)?b("",!0):(r(),B(g,{key:0,width:"24",height:"24"})),e(i)?(r(),B(v,{key:1,width:"24",height:"24"})):b("",!0)]),_:1}),s(W,{name:"fade"},{default:f(()=>[e(i)?(r(),B(T,{key:0,"backtest-history":e(t).activeBot.backtestHistory,"selected-backtest-result-key":e(t).activeBot.selectedBacktestResultKey,"can-use-modify":e(t).activeBot.botFeatures.backtestSetNotes,onSelectionChange:e(t).activeBot.setBacktestResultKey,onRemoveResult:e(t).activeBot.removeBacktestResultFromMemory,onUpdateResult:e(t).activeBot.saveBacktestResultMetadata},null,8,["backtest-history","selected-backtest-result-key","can-use-modify","onSelectionChange","onRemoveResult","onUpdateResult"])):b("",!0)]),_:1})])],2)):b("",!0),d("div",ya,[k[8]||(k[8]=d("h2",{class:"ms-5 text-3xl font-bold"},"Backtesting",-1)),e(t).activeBot.canRunBacktest?b("",!0):(r(),p("p",ga," Bot must be in webserver mode to enable Backtesting. ")),d("div",ha,[s(Ie,{value:e(u),"onUpdate:value":k[1]||(k[1]=ne=>Z(u)?u.value=ne:null),lazy:""},{default:f(()=>[s(D,null,{default:f(()=>[e(t).activeBot.botFeatures.backtestHistory?(r(),B(A,{key:0,class:"flex items-center",value:"historicResults",disabled:!e(t).activeBot.canRunBacktest},{default:f(()=>[s(h,{class:"me-2"}),k[2]||(k[2]=R("Load Results",-1))]),_:1},8,["disabled"])):b("",!0),s(A,{class:"flex items-center",value:"run",disabled:!e(t).activeBot.canRunBacktest},{default:f(()=>[s($,{class:"me-2"}),k[3]||(k[3]=R("Run backtest",-1))]),_:1},8,["disabled"]),s(A,{id:"bt-analyze-btn",class:"flex items-center",value:"results",disabled:!e(_)},{default:f(()=>[s(N,{class:"me-2"}),k[4]||(k[4]=R("Analyze result",-1))]),_:1},8,["disabled"]),e(m)?(r(),B(A,{key:1,class:"flex items-center",value:"compare-results",disabled:!e(m)},{default:f(()=>[s(X,{class:"me-2"}),k[5]||(k[5]=R("Compare results",-1))]),_:1},8,["disabled"])):b("",!0),s(A,{class:"flex items-center",value:"visualize-summary",disabled:!e(_)},{default:f(()=>[s(J,{class:"me-2"}),k[6]||(k[6]=R("Visualize summary",-1))]),_:1},8,["disabled"]),s(A,{class:"flex items-center",value:"visualize",disabled:!e(_)},{default:f(()=>[s(C,{class:"me-2"}),k[7]||(k[7]=R("Visualize result",-1))]),_:1},8,["disabled"])]),_:1}),s(De,null,{default:f(()=>[s(F,{value:"historicResults"},{default:f(()=>[s(P)]),_:1}),s(F,{value:"run"},{default:f(()=>[s(Me)]),_:1}),s(F,{value:"results"},{default:f(()=>[e(_)&&e(t).activeBot.selectedBacktestResult?(r(),B(Ae,{key:0,"backtest-result":e(t).activeBot.selectedBacktestResult,class:"flex-fill"},null,8,["backtest-result"])):b("",!0)]),_:1}),s(F,{value:"compare-results"},{default:f(()=>[e(m)?(r(),B(qe,{key:0,"backtest-results":e(t).activeBot.backtestHistory,class:"flex-fill"},null,8,["backtest-results"])):b("",!0)]),_:1}),s(F,{value:"visualize-summary"},{default:f(()=>[e(_)&&e(t).activeBot.selectedBacktestResult?(r(),B(Pe,{key:0,trades:e(t).activeBot.selectedBacktestResult.trades,class:"flex-fill"},null,8,["trades"])):b("",!0)]),_:1}),s(F,{value:"visualize",l:""},{default:f(()=>[e(t).activeBot.selectedBacktestResult?(r(),B(Le,{key:0,timeframe:e(a),strategy:e(l).strategy,timerange:e(l).timerange,"backtest-result":e(t).activeBot.selectedBacktestResult,"freqai-model":e(l).freqAI.enabled?e(l).freqAI.model:void 0},null,8,["timeframe","strategy","timerange","backtest-result","freqai-model"])):b("",!0)]),_:1})]),_:1})]),_:1},8,["value"]),Xe(d("small",{class:"text-end bt-running-label"},"Backtest running: "+x(e(t).activeBot.backtestStep)+" "+x(("formatPercent"in y?y.formatPercent:e(j))(e(t).activeBot.backtestProgress,2)),513),[[et,e(t).activeBot.backtestRunning]])])])])}}}),Ga=U(Ba,[["__scopeId","data-v-e3160bcd"]]);export{Ga as default};
//# sourceMappingURL=BacktestingView-B17Rl8p3.js.map
